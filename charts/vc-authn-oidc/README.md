# VC-AuthN OIDC

![Version: 0.2.4](https://img.shields.io/badge/Version-0.2.4-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 2.2.1](https://img.shields.io/badge/AppVersion-2.2.1-informational?style=flat-square)

A Helm chart to deploy Verifiable Credential Identity Provider for OpenID Connect.

See [here](/docs/README.md) for background into how this integration is defined.

Make sure to read the [best practices](/docs/BestPractices.md) to be used when protecting a web application using `vc-authn-oidc`.

## TL;DR

```console
helm repo add vc-authn-oidc https://bcgov.github.io/vc-authn-oidc
helm repo update
helm install my-release vc-authn-oidc/vc-authn-oidc
```

## Prerequisites

- Kubernetes 1.19+
- Helm 3.2.0+
- PV provisioner support in the underlying infrastructure

## Installing the Chart

To install the chart with the release name `my-release`:

```console
helm repo add vc-authn-oidc https://bcgov.github.io/vc-authn-oidc
helm install my-release vc-authn-oidc/vc-authn-oidc
```

The command deploys vc-authn-oidc with AcaPY agent, along with the MongoDB and PostgrSQL prerequisites on the Kubernetes cluster in the default configuration. The [Parameters](#parameters) section lists the parameters that can be configured during installation.

> **Tip**: List all releases using `helm list`

## Installing the Chart configured for external AcaPy instance

If necessary, vc-authn-oidc can be installed without AcaPY agent. This is accomplished by setting `acapy.enabled` to `false` and providing the necessary values to configure vc-authn-oidc to connect to an external AcaPy instance.

| Name                            | Description                                                                                                                               | Value   |
| ------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- | ------- |
| `acapy.enabled`                 | Set to `false` to not deploy included AcaPy instance                                                                                      | `false` |
| `acapy.agentUrl`                | Provide URL of the AcaPy agent instance                                                                                                   |         |
| `acapy.adminUrl`                | Provide URL of the AcaPy agent admin interface                                                                                            |         |
| `acapy.argfile.yml.wallet-name` | Provide the name of the wallet (`wallet-id`)                                                                                              |         |
| `acapy.existingSecret`          | Provide the name of an existing secret containing the values for `adminApiKey` (otherwise set using `acapy.adminApiKey`), and `walletKey` |         |

To obtain the `controllerApiKey` to be used with the external AcaPy instance, run the following command:

```console
export WEBHOOK_API_KEY=$(kubectl get secret --namespace my-namespace my-release-api-key -o jsonpath="{.data.controllerApiKey}" | base64 --decode; echo)

echo $WEBHOOK_API_KEY
```

## Uninstalling the Chart

To uninstall/delete the `my-release` deployment:

```console
helm delete my-release
```

The command removes all the Kubernetes components but secrets and PVC's associated with the chart and deletes the release.

To delete the secrets and PVC's associated with `my-release`:

```console
kubectl delete secret,pvc --selector "app.kubernetes.io/instance"=my-release
```

> **Note**: Deleting the PVC's will delete postgresql data as well. Please be cautious before doing it.

## Parameters

### Common Configuration

| Name                | Description                                                     | Value                           |
| ------------------- | --------------------------------------------------------------- | ------------------------------- |
| `nameOverride`      |                                                                 | `""`                            |
| `fullnameOverride`  |                                                                 | `""`                            |
| `image.repository`  |                                                                 | `ghcr.io/bcgov/vc-authn-oidc`   |
| `image.pullPolicy`  |                                                                 | `IfNotPresent`                  |
| `image.pullSecrets` |                                                                 | `[]`                            |
| `image.tag`         | Overrides the image tag which defaults to the chart appVersion. | `2.2.1`                         |
| `ingressSuffix`     | Domain suffix to be used for default hostpaths in ingress       | `.apps.silver.devops.gov.bc.ca` |

### Controller Configuration

| Name                                            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                            | Value                               |
|-------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
| `acapyTenancyMode`                              | Agent tenancy mode, either `single` or `multi`                                                                                                                                                                                                                                                                                                                                                                                                         | `single`                            |
| `setNonRevoked`                                 | if True, the `non_revoked` attributed will be added to each of the present-proof request `requested_attribute` and `requested_predicate` with 'from=0' and'to=`int(time.time())`                                                                                                                                                                                                                                                                       | `true`                              |
| `invitationLabel`                               | For the invitations sent that include the proof, what to add as the my_label field. Can be used to identify the requester to the prover                                                                                                                                                                                                                                                                                                                | `"VC-AuthN"`                        |
| `useOobPresentProof`                            | if True, the present-proof request will be provided as a an [out of band](https://github.com/hyperledger/aries-rfcs/tree/main/features/0434-outofband) invitation with a [present-proof](https://github.com/hyperledger/aries-rfcs/tree/main/features/0037-present-proof) request inside. If False, the present-proof request will be use the [service-decorator](https://github.com/hyperledger/aries-rfcs/tree/main/features/0056-service-decorator) | `false`                             |
| `useOobLocalDIDService`                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `false`                             |
| `useUrlDeepLink`                                | if True, will use the new encoded URL (`didcomm://?_url={redirect URL}`) redirect form of the deep link                                                                                                                                                                                                                                                                                                                                                | `false`                             |
| `walletDeepLinkPrefix`                          | Custom URI scheme and host to use for deep links (`{walletDeepLinkPrefix}?c_i={connection payload`)                                                                                                                                                                                                                                                                                                                                                    | `"bcwallet://aries_proof-request"`  |
| `controller.cameraRedirectUrl`                  | The redirect url can be a web link or the name of a template                                                                                                                                                                                                                                                                                                                                                                                           | `wallet_howto`                      |
| `controller.presentationExpire.time`            | The number of time in seconds a proof request will be valid for                                                                                                                                                                                                                                                                                                                                                                                        | `300`                               |
| `controller.sessionTimeout.duration`            | The number of seconds an auth_sessions in the states defined in `controllerSessionTimeoutConfig` is kept for                                                                                                                                                                                                                                                                                                                                           | `86400`                             |
| `controller.sessionTimeout.config`              | The list of auth session states that are safe for deletion                                                                                                                                                                                                                                                                                                                                                                                             | `[expired', 'failed', 'abandoned']` |
| `useHTTPS`                                      | Prepend Agent and Admin URLs with `https`                                                                                                                                                                                                                                                                                                                                                                                                              | `true`                              |
| `logLevel`                                      | Accepts one of the following values: CRITICAL, ERROR, WARNING, INFO, DEBUG                                                                                                                                                                                                                                                                                                                                                                             | `INFO`                              |
| `auth.api.existingSecret`                       | Specify the name of the secret containing `controllerApiKey` key.                                                                                                                                                                                                                                                                                                                                                                                      | `""`                                |
| `auth.token.privateKey.filename`                | Specify the name of the signing key file                                                                                                                                                                                                                                                                                                                                                                                                               | `jwt-token.pem`                     |
| `auth.token.privateKey.existingSecret`          | Specify the name of the secret containing the signing key to be mounted, if not specified, a new secret will be created.                                                                                                                                                                                                                                                                                                                               | `""`                                |
| `database.existingSecret`                       | Specify existing secret containing the keys `mongodb-root-password`, `mongodb-replica-set-key`, and `mongodb-passwords`. `database.secret.create` must be set to `false` when using existing secret.                                                                                                                                                                                                                                                   | `""`                                |
| `podAnnotations`                                | Map of annotations to add to the acapy pods                                                                                                                                                                                                                                                                                                                                                                                                            | `{}`                                |
| `podSecurityContext`                            | Pod Security Context                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                |
| `containerSecurityContext`                      | Container Security Context                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                |
| `networkPolicy.enabled`                         | Enable network policies                                                                                                                                                                                                                                                                                                                                                                                                                                | `true`                              |
| `networkPolicy.ingress.enabled`                 | Enable ingress rules                                                                                                                                                                                                                                                                                                                                                                                                                                   | `true`                              |
| `networkPolicy.ingress.namespaceSelector`       | Namespace selector label that is allowed to access the Tenant proxy pods.                                                                                                                                                                                                                                                                                                                                                                              | `{}`                                |
| `networkPolicy.ingress.podSelector`             | Pod selector label that is allowed to access the Tenant proxy pods.                                                                                                                                                                                                                                                                                                                                                                                    | `{}`                                |
| `service.type`                                  | Kubernetes Service type                                                                                                                                                                                                                                                                                                                                                                                                                                | `ClusterIP`                         |
| `service.port`                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `5000`                              |
| `ingress.enabled`                               | Enable ingress record generation for controller                                                                                                                                                                                                                                                                                                                                                                                                        | `true`                              |
| `ingress.className`                             | IngressClass that will be be used to implement the Ingress (Kubernetes 1.18+)                                                                                                                                                                                                                                                                                                                                                                          | `""`                                |
| `ingress.annotations`                           | Additional annotations for the Ingress resource.                                                                                                                                                                                                                                                                                                                                                                                                       | `[]`                                |
| `ingress.tls`                                   | Enable TLS configuration for the host defined at ingress.                                                                                                                                                                                                                                                                                                                                                                                              | `[]`                                |
| `resources.limits.memory`                       | The memory limit for the controller containers                                                                                                                                                                                                                                                                                                                                                                                                         | `512Mi`                             |
| `resources.limits.cpu`                          | The cpu limit for the controller containers                                                                                                                                                                                                                                                                                                                                                                                                            | `100m`                              |
| `resources.requests.memory`                     | The requested memory for the controller containers                                                                                                                                                                                                                                                                                                                                                                                                     | `128Mi`                             |
| `resources.requests.cpu`                        | The requested cpu for the controller containers                                                                                                                                                                                                                                                                                                                                                                                                        | `10m`                               |
| `replicaCount`                                  | Number of controller replicas to deploy                                                                                                                                                                                                                                                                                                                                                                                                                | `1`                                 |
| `autoscaling.enabled`                           | Enable Horizontal POD autoscaling forthe controller                                                                                                                                                                                                                                                                                                                                                                                                    | `true`                              |
| `autoscaling.minReplicas`                       | Minimum number of controller replicas                                                                                                                                                                                                                                                                                                                                                                                                                  | `1`                                 |
| `autoscaling.maxReplicas`                       | Maximum number of controller replicas                                                                                                                                                                                                                                                                                                                                                                                                                  | `2`                                 |
| `autoscaling.targetCPUUtilizationPercentage`    | Target CPU utilization percentage                                                                                                                                                                                                                                                                                                                                                                                                                      | `80`                                |
| `autoscaling.targetMemoryUtilizationPercentage` | Target Memory utilization percentage                                                                                                                                                                                                                                                                                                                                                                                                                   | `""`                                |
| `autoscaling.stabilizationWindowSeconds`        | Stabilization window in seconds                                                                                                                                                                                                                                                                                                                                                                                                                        | `300`                               |
| `serviceAccount.create`                         | Specifies whether a ServiceAccount should be created                                                                                                                                                                                                                                                                                                                                                                                                   | `false`                             |
| `serviceAccount.annotations`                    | Annotations for service account. Evaluated as a template. Only used if `create` is `true`.                                                                                                                                                                                                                                                                                                                                                             | `{}`                                |
| `serviceAccount.automountServiceAccountToken`   | Automount service account token for the server service account                                                                                                                                                                                                                                                                                                                                                                                         | `true`                              |
| `serviceAccount.name`                           | Name of the service account to use. If not set and create is true, a name is generated using the fullname template.                                                                                                                                                                                                                                                                                                                                    | `""`                                |
| `affinity`                                      | Affinity for pods assignment                                                                                                                                                                                                                                                                                                                                                                                                                           | `{}`                                |
| `nodeSelector`                                  | Node labels for pods assignment                                                                                                                                                                                                                                                                                                                                                                                                                        | `{}`                                |
| `tolerations`                                   | Tolerations for pods assignment                                                                                                                                                                                                                                                                                                                                                                                                                        | `[]`                                |

### Acapy Configuration

| Name                                                  | Description                                                                                                                          | Value                                         |
| ----------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------- |
| `acapy.enabled`                                       | Deploy AcaPy agent instance                                                                                                          | `true`                                        |
| `acapy.agentUrl`                                      | Agent host, required if `enabled` is `false`, otherwise ignored                                                                      | `""`                                          |
| `acapy.adminUrl`                                      | Agent admin host, required if `enabled` is `false`, otherwise ignored                                                                | `""`                                          |
| `acapy.existingSecret`                                | Name of existing secret, required if `enabled` is `false`; Secret must contain `adminApiKey`, `walletKey`, and `webhookApiKey` keys. | `""`                                          |
| `acapy.agentSeed.seed`                                |                                                                                                                                      | `""`                                          |
| `acapy.agentSeed.existingSecret`                      | Name of existing secret with the `seed` key.                                                                                         | `""`                                          |
| `acapy.image.repository`                              |                                                                                                                                      | `ghcr.io/hyperledger/aries-cloudagent-python` |
| `acapy.image.pullPolicy`                              |                                                                                                                                      | `IfNotPresent`                                |
| `acapy.image.pullSecrets`                             |                                                                                                                                      | `[]`                                          |
| `acapy.image.tag`                                     |                                                                                                                                      | `py3.9-0.9.0`                                 |
| `acapy.serviceAccount.create`                         | Specifies whether a ServiceAccount should be created                                                                                 | `false`                                       |
| `acapy.serviceAccount.annotations`                    | Annotations for service account. Evaluated as a template. Only used if `create` is `true`.                                           | `{}`                                          |
| `acapy.serviceAccount.automountServiceAccountToken`   | Automount service account token for the server service account                                                                       | `true`                                        |
| `acapy.serviceAccount.name`                           | Name of the service account to use. If not set and create is true, a name is generated using the fullname template.                  | `""`                                          |
| `acapy.replicaCount`                                  | Number of AcaPy replicas to deploy                                                                                                   | `1`                                           |
| `acapy.autoscaling.enabled`                           | Enable Horizontal POD autoscaling for AcaPy                                                                                          | `true`                                        |
| `acapy.autoscaling.minReplicas`                       | Minimum number of AcaPy replicas                                                                                                     | `1`                                           |
| `acapy.autoscaling.maxReplicas`                       | Maximum number of AcaPy replicas                                                                                                     | `100`                                         |
| `acapy.autoscaling.targetCPUUtilizationPercentage`    | Target CPU utilization percentage                                                                                                    | `80`                                          |
| `acapy.autoscaling.targetMemoryUtilizationPercentage` | Target Memory utilization percentage                                                                                                 | `""`                                          |
| `acapy.autoscaling.stabilizationWindowSeconds`        | Stabilization window in seconds                                                                                                      | `300`                                         |
| `acapy.labelOverride`                                 |                                                                                                                                      | `""`                                          |

### Acapy configuration file

Configuration file is mounted as is into the container. See the AcaPy documentation for details.
Note: Secure values of the configuration are passed via equivalent environment variables from secrets.

| Name                                              | Description                                                                                                                                                                                                                                                                                                                             | Value                                  |
| ------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------- |
| `acapy.argfile.yml.admin-insecure-mode`           | Run the admin web server in insecure mode. DO NOT USE FOR PRODUCTION DEPLOYMENTS. The admin server will be publicly available to anyone who has access to the interface. An auto-generated admin API Key is supplied via `ACAPY-ADMIN-API-KEY`.                                                                                         | `false`                                |
| `acapy.argfile.yml.auto-accept-invites`           | Automatically accept invites without firing a webhook event or waiting for an admin request. Default: false.                                                                                                                                                                                                                            | `true`                                 |
| `acapy.argfile.yml.auto-accept-requests`          | Automatically accept connection requests without firing a webhook event or waiting for an admin request. Default: false.                                                                                                                                                                                                                | `true`                                 |
| `acapy.argfile.yml.auto-ping-connection`          | Automatically send a trust ping immediately after a connection response is accepted. Some agents require this before marking a connection as 'active'. Default: false.                                                                                                                                                                  | `true`                                 |
| `acapy.argfile.yml.auto-provision`                | If the requested profile does not exist, initialize it with the given parameters.                                                                                                                                                                                                                                                       | `true`                                 |
| `acapy.argfile.yml.auto-respond-credential-offer` | Automatically respond to Indy credential offers with a credential request. Default: false                                                                                                                                                                                                                                               | `true`                                 |
| `acapy.argfile.yml.auto-respond-messages`         | Automatically respond to basic messages indicating the message was received. Default: false.                                                                                                                                                                                                                                            | `true`                                 |
| `acapy.argfile.yml.auto-verify-presentation`      | Automatically verify a presentation when it is received. Default: false.                                                                                                                                                                                                                                                                | `true`                                 |
| `acapy.argfile.yml.genesis-transactions-list`     | Load YAML configuration for connecting to multiple HyperLedger Indy ledgers.                                                                                                                                                                                                                                                            | `/tmp/ledgers.yml`                     |
| `acapy.argfile.yml.label`                         | Specifies the label for this agent. This label is publicized (self-attested) to other agents as part of forming a connection. Set to release name by default.                                                                                                                                                                           | `{{ include "acapy.label" .}}`         |
| `acapy.argfile.yml.log-level`                     | Specifies a custom logging level as one of: ('debug', 'info', 'warning', 'error', 'critical')                                                                                                                                                                                                                                           | `info`                                 |
| `acapy.argfile.yml.monitor-ping`                  | Send a webhook when a ping is sent or received.                                                                                                                                                                                                                                                                                         | `true`                                 |
| `acapy.argfile.yml.multitenant-admin`             | Specify whether to enable the multitenant admin api.                                                                                                                                                                                                                                                                                    | `false`                                |
| `acapy.argfile.yml.multitenant`                   | Enable multitenant mode.                                                                                                                                                                                                                                                                                                                | `false`                                |
| `acapy.argfile.yml.public-invites`                | Send invitations out using the public DID for the agent, and receive connection requests solicited by invitations which use the public DID. Default: false.                                                                                                                                                                             | `true`                                 |
| `acapy.argfile.yml.read-only-ledger`              | Sets ledger to read-only to prevent updates. Default: false.                                                                                                                                                                                                                                                                            | `true`                                 |
| `acapy.argfile.yml.wallet-local-did`              | If this parameter is set, provisions the wallet with a local DID from the '--seed' parameter, instead of a public DID to use with a Hyperledger Indy ledger. Default: false.                                                                                                                                                            | `true`                                 |
| `acapy.argfile.yml.wallet-name`                   | Specifies the wallet name to be used by the agent. This is useful if your deployment has multiple wallets.                                                                                                                                                                                                                              | `askar-wallet`                         |
| `acapy.argfile.yml.wallet-storage-type`           | Specifies the type of Indy wallet backend to use. Supported internal storage types are 'basic' (memory), 'default' (sqlite), and 'postgres_storage'. The default, if not specified, is 'default'.                                                                                                                                       | `postgres_storage`                     |
| `acapy.argfile.yml.wallet-type`                   | Specifies the type of Indy wallet provider to use. Supported internal storage types are 'basic' (memory) and 'indy'. The default (if not specified) is 'basic'.                                                                                                                                                                         | `askar`                                |
| `acapy.argfile.yml.webhook-url`                   | Send webhooks containing internal state changes to the specified URL. Optional API key to be passed in the request body can be appended using a hash separator [#]. This is useful for a controller to monitor agent events and respond to those events using the admin API. If not specified, webhooks are not published by the agent. | `{{ include "vc-authn-oidc.host" . }}` |
| `acapy.ledgers.yml`                               |                                                                                                                                                                                                                                                                                                                                         | `{}`                                   |

### Wallet Storage configuration

| Name                                        | Description                                                                                                                                                            | Value               |
| ------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------- |
| `acapy.walletStorageConfig.json`            | Raw json, overrides all other values including postgres subchart values. e.g.: '{"url":"localhost:5432", "max_connections":"10", "wallet_scheme":"DatabasePerWallet"}' | `""`                |
| `acapy.walletStorageConfig.url`             | Database url. Overrides all other values including postgres subchart values.                                                                                           | `""`                |
| `acapy.walletStorageConfig.max_connections` | Client max connections, defaults to 10.                                                                                                                                | `10`                |
| `acapy.walletStorageConfig.wallet_scheme`   | Wallet scheme.                                                                                                                                                         | `DatabasePerWallet` |

### Wallet Storage Credentials

| Name                                                         | Description                                                                                                                                                                                                                    | Value               |
| ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------- |
| `acapy.walletStorageCredentials.json`                        | Raw json with database credentials. Overrides all other values including postgres subchart values. e.g.: '{"account":"postgres","password":"mysecretpassword","admin_account":"postgres","admin_password":"mysecretpassword"}' | `""`                |
| `acapy.walletStorageCredentials.account`                     | Database account name.                                                                                                                                                                                                         | `""`                |
| `acapy.walletStorageCredentials.admin_account`               | Database account with CREATEDB role used to create additional databases per wallet.                                                                                                                                            | `postgres`          |
| `acapy.walletStorageCredentials.admin_password`              | Database password for admin account.                                                                                                                                                                                           | `""`                |
| `acapy.walletStorageCredentials.existingSecret`              | Name of an existing secret containing 'database-user', 'database-password', 'admin-password' keys.                                                                                                                             | `""`                |
| `acapy.walletStorageCredentials.secretKeys.adminPasswordKey` | Key in existing secret containing admin password                                                                                                                                                                               | `admin-password`    |
| `acapy.walletStorageCredentials.secretKeys.userPasswordKey`  | Key in existing secret containing password                                                                                                                                                                                     | `database-password` |

### Acapy tails persistence configuration

| Name                              | Description                                                                              | Value                            |
| --------------------------------- | ---------------------------------------------------------------------------------------- | -------------------------------- |
| `acapy.persistence.existingClaim` | Name of an existing PVC to use                                                           | `""`                             |
| `acapy.persistence.mountPath`     |                                                                                          | `/home/aries/.indy_client/tails` |
| `acapy.persistence.storageClass`  | PVC Storage Class                                                                        | `""`                             |
| `acapy.persistence.accessModes`   | PVC Access Mode. ReadWriteMany is required for each Acapy pod to access the same volume. | `["ReadWriteMany"]`              |
| `acapy.persistence.size`          | PVC Storage Request for tails volume                                                     | `1Gi`                            |

### Acapy common configurations

| Name                              | Description                                   | Value       |
| --------------------------------- | --------------------------------------------- | ----------- |
| `acapy.resources.limits.memory`   | The memory limit for the Acapy containers     | `1000Mi`    |
| `acapy.resources.limits.cpu`      | The cpu limit for the Acapy containers        | `1`         |
| `acapy.resources.requests.memory` | The requested memory for the Acapy containers | `384Mi`     |
| `acapy.resources.requests.cpu`    | The requested cpu for the Acapy containers    | `250m`      |
| `acapy.podAnnotations`            | Map of annotations to add to the acapy pods   | `{}`        |
| `acapy.podSecurityContext`        | Pod Security Context                          | `{}`        |
| `acapy.containerSecurityContext`  | Container Security Context                    | `{}`        |
| `acapy.service.type`              | Kubernetes Service type                       | `ClusterIP` |
| `acapy.service.adminPort`         | Port to expose for admin service              | `8031`      |
| `acapy.service.httpPort`          | Port to expose for http service               | `8030`      |
| `acapy.affinity`                  | Affinity for acapy pods assignment            | `{}`        |
| `acapy.nodeSelector`              | Node labels for acapy pods assignment         | `{}`        |
| `acapy.tolerations`               | Tolerations for acapy pods assignment         | `[]`        |

### Acapy NetworkPolicy parameters

| Name                                            | Description                                                               | Value  |
| ----------------------------------------------- | ------------------------------------------------------------------------- | ------ |
| `acapy.networkPolicy.enabled`                   | Enable network policies                                                   | `true` |
| `acapy.networkPolicy.ingress.enabled`           | Enable ingress rules                                                      | `true` |
| `acapy.networkPolicy.ingress.namespaceSelector` | Namespace selector label that is allowed to access the Tenant proxy pods. | `{}`   |
| `acapy.networkPolicy.ingress.podSelector`       | Pod selector label that is allowed to access the Tenant proxy pods.       | `{}`   |

### Acapy OpenShift Route parameters

| Name                                                           | Description                                                                                                                                                 | Value                                         |
| -------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------- |
| `acapy.openshift.route.enabled`                                | Create OpenShift Route resource for Acapy                                                                                                                   | `false`                                       |
| `acapy.openshift.route.path`                                   | Path that the router watches for, to route traffic to the service                                                                                           | `/`                                           |
| `acapy.openshift.route.targetPort`                             | Target port for the service                                                                                                                                 | `http`                                        |
| `acapy.openshift.route.timeout`                                | Timeout in seconds for a route to return                                                                                                                    | `2m`                                          |
| `acapy.openshift.route.tls.enabled`                            | Enable TLS termination                                                                                                                                      | `true`                                        |
| `acapy.openshift.route.tls.insecureEdgeTerminationPolicy`      | TLS termination policy                                                                                                                                      | `None`                                        |
| `acapy.openshift.route.tls.termination`                        | TLS termination type                                                                                                                                        | `edge`                                        |
| `acapy.openshift.route.wildcardPolicy`                         | Wildcard policy for the route                                                                                                                               | `None`                                        |
| `acapy.openshift.adminRoute.enabled`                           | Create OpenShift Route resource for Acapy admin service                                                                                                     | `false`                                       |
| `acapy.openshift.adminRoute.path`                              | Path that the router watches for, to route traffic to the service                                                                                           | `/`                                           |
| `acapy.openshift.adminRoute.targetPort`                        | Target port for the service                                                                                                                                 | `admin`                                       |
| `acapy.openshift.adminRoute.timeout`                           | Timeout in seconds for a route to return                                                                                                                    | `2m`                                          |
| `acapy.openshift.adminRoute.tls.enabled`                       | Enable TLS termination                                                                                                                                      | `true`                                        |
| `acapy.openshift.adminRoute.tls.insecureEdgeTerminationPolicy` | TLS termination policy                                                                                                                                      | `None`                                        |
| `acapy.openshift.adminRoute.tls.termination`                   | TLS termination type                                                                                                                                        | `edge`                                        |
| `acapy.openshift.adminRoute.wildcardPolicy`                    | Wildcard policy for the route                                                                                                                               | `None`                                        |
| `mongodb.auth.enabled`                                         | Enable authentication                                                                                                                                       | `true`                                        |
| `mongodb.auth.existingSecret`                                  | Existing secret with MongoDB(&reg;) credentials (keys: `mongodb-passwords`, `mongodb-root-password`, `mongodb-metrics-password`, `mongodb-replica-set-key`) | `{{ include "global.fullname" . }}`           |
| `mongodb.auth.usernames`                                       | List of custom users to be created during the initialization                                                                                                | `["vcauthn"]`                                 |
| `mongodb.auth.databases`                                       | List of custom databases to be created during the initialization                                                                                            | `["vcauthn"]`                                 |
| `mongodb.commonLabels`                                         | Add labels to all the deployed resources (sub-charts are not considered). Evaluated as a template                                                           | `[]`                                          |
| `mongodb.image.registry`                                       | image registry                                                                                                                                              | `artifacts.developer.gov.bc.ca/docker-remote` |
| `mongodb.architecture`                                         | MongoDB(&reg;) architecture (`standalone` or `replicaset`)                                                                                                  | `replicaset`                                  |
| `mongodb.containerSecurityContext.enabled`                     | Enable MongoDB(&reg;) container(s)' Security Context                                                                                                        | `false`                                       |
| `mongodb.podSecurityContext.enabled`                           | Enable MongoDB(&reg;) pod(s)' Security Context                                                                                                              | `false`                                       |
| `mongodb.persistence.enabled`                                  | Enable MongoDB(&reg;) data persistence using PVC                                                                                                            | `true`                                        |
| `mongodb.persistence.storageClass`                             | PVC Storage Class for MongoDB(&reg;) data volume                                                                                                            | `netapp-block-standard`                       |
| `mongodb.serviceAccount.create`                                | Enable creation of ServiceAccount for MongoDB(&reg;) pods                                                                                                   | `false`                                       |
| `mongodb.arbiter.enabled`                                      | Enable deploying the arbiter                                                                                                                                | `false`                                       |
| `mongodb.hidden.enabled`                                       | Enable deploying the hidden nodes                                                                                                                           | `false`                                       |
| `mongodb.metrics.enabled`                                      | Enable using a sidecar Prometheus exporter                                                                                                                  | `false`                                       |

### PostgreSQL parameters

| Name                                                  | Description                                                                                                                                                                                                                                                                                                                                                                    | Value                               |
| ----------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------- |
| `postgresql.enabled`                                  | Deploy Bitnami PostgreSQL chart.                                                                                                                                                                                                                                                                                                                                               | `true`                              |
| `postgresql.fullnameOverride`                         | When overriding fullnameOverride, you must override this to match.                                                                                                                                                                                                                                                                                                             | `""`                                |
| `postgresql.architecture`                             | PostgreSQL architecture (`standalone` or `replication`)                                                                                                                                                                                                                                                                                                                        | `standalone`                        |
| `postgresql.commonLabels`                             | Add labels to all the deployed resources (sub-charts are not considered).                                                                                                                                                                                                                                                                                                      | `[]`                                |
| `postgresql.auth.enablePostgresUser`                  | Assign a password to the "postgres" admin user. Otherwise, remote access will be blocked for this user                                                                                                                                                                                                                                                                         | `true`                              |
| `postgresql.auth.existingSecret`                      | Name of existing secret to use for PostgreSQL credentials. `postgresql.auth.postgresPassword`, `postgresql.auth.password`, and `postgresql.auth.replicationPassword` will be ignored and picked up from this secret. The secret might also contains the key `ldap-password` if LDAP is enabled. `ldap.bind_password` will be ignored and picked from this secret in this case. | `{{ include "global.fullname" . }}` |
| `postgresql.auth.secretKeys.adminPasswordKey`         | Name of key in existing secret to use for PostgreSQL credentials. Only used when `auth.existingSecret` is set.                                                                                                                                                                                                                                                                 | `admin-password`                    |
| `postgresql.auth.secretKeys.userPasswordKey`          | Name of key in existing secret to use for PostgreSQL credentials. Only used when `auth.existingSecret` is set.                                                                                                                                                                                                                                                                 | `database-password`                 |
| `postgresql.auth.database`                            | Name for a custom database to create                                                                                                                                                                                                                                                                                                                                           | `traction`                          |
| `postgresql.auth.username`                            | Name for a custom user to create                                                                                                                                                                                                                                                                                                                                               | `acapy`                             |
| `postgresql.primary.persistence.enabled`              | Enable PostgreSQL Primary data persistence using PVC                                                                                                                                                                                                                                                                                                                           | `true`                              |
| `postgresql.primary.persistence.size`                 | PVC Storage Request for PostgreSQL volume                                                                                                                                                                                                                                                                                                                                      | `1Gi`                               |
| `postgresql.primary.containerSecurityContext.enabled` | Enable container security context                                                                                                                                                                                                                                                                                                                                              | `false`                             |
| `postgresql.primary.podSecurityContext.enabled`       | Enable security context                                                                                                                                                                                                                                                                                                                                                        | `false`                             |
| `postgresql.primary.resources.limits.memory`          | The memory limit for the PostgreSQL Primary containers                                                                                                                                                                                                                                                                                                                         | `2600Mi`                            |
| `postgresql.primary.resources.limits.cpu`             | The cpu limit for the PostgreSQL Primary containers                                                                                                                                                                                                                                                                                                                            | `600m`                              |
| `postgresql.primary.resources.requests.memory`        | The requested memory for the PostgreSQL Primary containers                                                                                                                                                                                                                                                                                                                     | `1300Mi`                            |
| `postgresql.primary.resources.requests.cpu`           | The requested cpu for the PostgreSQL Primary containers                                                                                                                                                                                                                                                                                                                        | `300m`                              |
| `postgresql.primary.service.ports.postgresql`         | PostgreSQL service port                                                                                                                                                                                                                                                                                                                                                        | `5432`                              |
| `postgresql.primary.extendedConfiguration`            | Extended PostgreSQL Primary configuration (appended to main or default configuration)                                                                                                                                                                                                                                                                                          | `max_connections = 500`             |

---

Autogenerated from chart metadata using [helm-docs v1.11.0](https://github.com/norwoodj/helm-docs/releases/v1.11.0)
